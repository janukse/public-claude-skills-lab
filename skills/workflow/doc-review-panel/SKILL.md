---
name: doc-review-panel
description: 문서를 여러 페르소나(전문가 패널)가 각자의 관점에서 검토하고 종합 리포트를 생성하는 워크플로우
argument-hint: "<문서 경로> [--personas \"페르소나1, ...\"] [--recommend] [--parallel]"
---

# Doc Review Panel

## 목적

문서를 여러 전문가 페르소나가 각자의 관점에서 검토하여 다면적 피드백을 제공하는 워크플로우.

- 사용자가 정의한 페르소나별로 문서를 독립 검토
- 병렬(에이전트 팀) 또는 순차(단일 세션) 검토 모드 선택 가능
- 페르소나별 검토 결과를 종합하여 우선순위별 액션 리포트 생성
- 프리셋 페르소나 세트 제공 (기술, 비즈니스, 종합 등)
- 문서 내용을 분석하여 최적의 검토 페르소나를 자동 추천

## 사용법

```
/doc-review-panel docs/architecture.md --personas "시니어 백엔드 엔지니어, 보안 전문가, DevOps 엔지니어"
/doc-review-panel README.md --preset tech
/doc-review-panel spec.md --recommend
/doc-review-panel spec.md --personas "PM, UX 디자이너, QA 리드" --parallel
/doc-review-panel proposal.pdf --preset business --parallel
```

### 옵션

| 옵션 | 설명 |
|------|------|
| `<문서 경로>` | 검토할 문서 파일 경로 (필수) |
| `--personas "A, B, C"` | 쉼표로 구분한 페르소나 목록 (커스텀) |
| `--preset <이름>` | 프리셋 페르소나 세트 사용 (아래 표 참고) |
| `--recommend` | 문서 내용을 분석하여 최적의 페르소나 패널을 자동 추천 |
| `--parallel` | 에이전트 팀을 사용한 병렬 검토 (기본: 순차) |
| `--focus "주제"` | 검토 시 특별히 집중할 주제/질문 지정 |

### 프리셋 페르소나 세트

| 프리셋 | 페르소나 구성 | 적합한 문서 |
|--------|--------------|-------------|
| `tech` | 시니어 엔지니어, 보안 전문가, 성능 전문가, QA 리드 | 설계 문서, API 스펙, 아키텍처 문서 |
| `business` | 비즈니스 전략가, 마케팅 전문가, 재무 분석가, 고객 경험 전문가 | 사업 계획서, 제안서, 기획서 |
| `product` | PM, UX 디자이너, 프론트엔드 엔지니어, 데이터 분석가 | PRD, 기능 명세, 와이어프레임 설명 |
| `docs` | 테크니컬 라이터, 초보 개발자, 비영어권 독자, 접근성 전문가 | README, 가이드, 튜토리얼 |
| `startup` | CTO, 투자자, 잠재 고객, 경쟁사 분석가 | 피치덱, 사업계획서, MVP 기획 |

## Workflow

### Step 1: 문서 로드 및 분석

#### 1a: 문서 읽기

`Read` 도구로 대상 문서를 읽는다. PDF인 경우 페이지를 지정하여 읽는다.

**문서를 찾을 수 없으면** "지정한 문서를 찾을 수 없습니다: `<경로>`"를 출력하고 종료한다.

#### 1b: 문서 메타 분석

문서의 유형과 특성을 파악한다:

| 분석 항목 | 내용 |
|-----------|------|
| 문서 유형 | 기술 문서 / 기획서 / 제안서 / 가이드 / 기타 |
| 분량 | 라인 수 / 추정 단어 수 |
| 주요 주제 | 문서가 다루는 핵심 주제 3-5개 |
| 대상 독자 | 문서의 의도된 독자층 |

### Step 2: 페르소나 구성

#### 2a: 페르소나 결정

인수를 분석하여 페르소나를 결정한다. 우선순위:

1. `--personas` 지정 → 쉼표로 분리하여 페르소나 목록 생성
2. `--preset` 지정 → 해당 프리셋의 페르소나 목록 사용
3. `--recommend` 지정 → **Step 2a-R: 페르소나 추천** 실행
4. **아무 옵션도 없으면** → **Step 2a-R: 페르소나 추천** 자동 실행

#### 2a-R: 페르소나 추천

Step 1b의 문서 메타 분석 결과를 기반으로 최적의 검토 페르소나를 추천한다.

**추천 알고리즘:**

다음 5가지 차원에서 문서를 분석하고, 각 차원에서 필요한 전문가를 도출한다:

| 분석 차원 | 분석 내용 | 추천 페르소나 예시 |
|-----------|----------|------------------|
| **도메인** | 문서가 다루는 기술/비즈니스 영역 | API 문서 → API 설계 전문가, 금융 기획 → 재무 분석가 |
| **이해관계자** | 문서의 결정에 영향받는 사람들 | 배포 전략 → DevOps, SRE / 기능 명세 → PM, QA |
| **리스크** | 문서에서 잘못되면 치명적인 영역 | 인증 설계 → 보안 전문가 / 과금 로직 → 재무 전문가 |
| **품질 속성** | 문서가 달성해야 할 품질 기준 | 성능 요구사항 → 성능 전문가 / 접근성 → UX 전문가 |
| **대상 독자** | 문서를 읽을 사람의 관점 | 신규 입사자용 → 주니어 개발자 / 경영진 보고 → CTO |

**추천 결과 형식:**

```markdown
## 페르소나 추천 결과

### 문서 분석 요약
- **유형**: <문서 유형>
- **핵심 주제**: <주제 1>, <주제 2>, <주제 3>
- **감지된 리스크 영역**: <영역들>

### 추천 패널 (추천순)

| # | 페르소나 | 추천 이유 | 관련 차원 |
|---|---------|----------|----------|
| 1 | <이름> | <이 문서에 왜 필요한지 1문장> | 도메인, 리스크 |
| 2 | <이름> | <이 문서에 왜 필요한지 1문장> | 이해관계자 |
| 3 | <이름> | <이 문서에 왜 필요한지 1문장> | 품질 속성 |
| 4 | <이름> | <이 문서에 왜 필요한지 1문장> | 대상 독자 |

### 고려했지만 제외한 관점
| 페르소나 | 제외 이유 |
|---------|----------|
| <이름> | <이 문서에서는 불필요한 이유> |
```

**추천 원칙:**

- 3-5명을 추천한다 (너무 많으면 검토 비용 증가, 너무 적으면 관점 부족)
- **긴장 관계**를 의도적으로 포함한다 (예: "빠른 출시" vs "품질 보장" 관점)
- 프리셋에 없는 **문서 맞춤 페르소나**도 자유롭게 추천한다
- 추천 이유를 반드시 명시하여 사용자가 판단할 수 있게 한다

`AskUserQuestion`으로 확인:
- "추천대로 진행" — 추천된 패널로 Step 2b 진행
- "일부 수정 후 진행" — 사용자가 추가/제거/변경
- "프리셋으로 대체" — 프리셋 선택 화면으로 전환
- "취소" — 종료

#### 2b: 페르소나 프로필 생성

각 페르소나에 대해 검토 프로필을 생성한다:

```markdown
## 검토 패널 구성

| # | 페르소나 | 검토 관점 | 중점 평가 항목 |
|---|---------|-----------|---------------|
| 1 | <이름> | <관점 설명> | <평가 항목 3-4개> |
| 2 | <이름> | <관점 설명> | <평가 항목 3-4개> |
```

각 페르소나의 **검토 관점**과 **중점 평가 항목**은 페르소나의 전문 영역에서 자동 도출한다. `--focus` 옵션이 있으면 모든 페르소나의 평가 항목에 해당 주제를 추가한다.

`AskUserQuestion`으로 확인:
- "이대로 검토 시작" — Step 3으로 진행
- "페르소나 수정" — 사용자가 프로필을 수정
- "취소" — 종료

### Step 3: 검토 실행

`--parallel` 옵션 여부에 따라 분기한다.

#### 3a: 순차 검토 모드 (기본)

단일 세션에서 각 페르소나의 관점을 순차적으로 적용하여 검토한다.

각 페르소나별로 다음을 수행:

1. 해당 페르소나의 역할과 전문성을 명시적으로 선언
2. 검토 관점과 중점 평가 항목에 따라 문서를 분석
3. 아래 **검토 결과 형식**에 맞게 결과를 작성

#### 3b: 병렬 검토 모드 (`--parallel`)

에이전트 팀을 사용하여 페르소나별 병렬 검토를 수행한다.

**Step 3b-1: 환경 확인**

```bash
echo $CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS
```

활성화되어 있지 않으면 안내 후 순차 모드로 폴백한다.

**Step 3b-2: 팀 생성**

`TeamCreate`로 팀을 생성한다:
- 팀 이름: `doc-review-<문서명(kebab-case)>`

**Step 3b-3: 작업 생성 및 팀원 배치**

각 페르소나별로:
1. `TaskCreate`로 검토 작업 생성
2. `Task` 도구로 팀원 생성 (subagent_type: `general-purpose`)
3. `TaskUpdate`로 작업 할당

**팀원 프롬프트 구조:**

```
당신은 [페르소나명]입니다. [전문 영역 설명]

## 검토 대상 문서
[문서 내용 또는 경로]

## 검토 관점
[관점 설명]

## 중점 평가 항목
- [항목 1]
- [항목 2]
- [항목 3]

## 검토 결과 형식
다음 형식으로 검토 결과를 작성하세요:

### [페르소나명] 검토 결과

**총평:** (2-3문장으로 전체 평가)

**점수:** [1-10] / 10

#### 강점
- [강점 1]
- [강점 2]

#### 개선 필요 사항
| 우선순위 | 위치/섹션 | 이슈 | 개선 제안 |
|---------|----------|------|----------|
| 🔴 높음 | <위치> | <문제> | <제안> |
| 🟡 중간 | <위치> | <문제> | <제안> |
| 🟢 낮음 | <위치> | <문제> | <제안> |

#### 질문 사항
- [이 페르소나 관점에서 저자에게 묻고 싶은 질문]

검토가 완료되면 TaskUpdate로 작업을 completed로 표시하세요.
```

**Step 3b-4: 모니터링**

`TaskList`로 진행 상황을 확인하고, 모든 작업이 완료될 때까지 대기한다.

**Step 3b-5: 팀 종료**

모든 검토가 완료되면 팀원에게 `shutdown_request`를 보내고 `TeamDelete`로 정리한다.

### 검토 결과 형식

각 페르소나의 검토는 다음 형식을 따른다:

```markdown
### [페르소나명] 검토 결과

**총평:** (2-3문장으로 전체 평가)

**점수:** [1-10] / 10

#### 강점
- [강점 1]
- [강점 2]

#### 개선 필요 사항
| 우선순위 | 위치/섹션 | 이슈 | 개선 제안 |
|---------|----------|------|----------|
| 🔴 높음 | <위치> | <문제> | <제안> |
| 🟡 중간 | <위치> | <문제> | <제안> |
| 🟢 낮음 | <위치> | <문제> | <제안> |

#### 질문 사항
- [질문]
```

### Step 4: 종합 리포트 생성

모든 페르소나의 검토 결과를 종합하여 최종 리포트를 작성한다.

```markdown
# 📋 문서 검토 종합 리포트

## 문서 정보
| 항목 | 내용 |
|------|------|
| 문서 | `<파일명>` |
| 검토 모드 | 순차 / 병렬 |
| 패널 구성 | <페르소나 목록> |
| 검토 일시 | <날짜> |

## 페르소나별 점수 요약

| 페르소나 | 점수 | 한줄 총평 |
|---------|------|----------|
| <이름> | <점수>/10 | <총평 요약> |
| **평균** | **<평균>/10** | |

## 공통 강점
- [여러 페르소나가 공통으로 언급한 강점]

## 핵심 개선 사항 (우선순위순)

여러 페르소나의 피드백을 종합하여 우선순위별로 정리한다:

| 순위 | 이슈 | 관련 페르소나 | 영향도 | 개선 제안 |
|------|------|-------------|--------|----------|
| 1 | <이슈> | <언급한 페르소나들> | 높음/중간/낮음 | <종합 제안> |
| 2 | <이슈> | <언급한 페르소나들> | 높음/중간/낮음 | <종합 제안> |

## 상충하는 의견
[페르소나 간 의견이 다른 부분이 있으면 정리. 없으면 "없음"]

## 핵심 질문 모음
- [각 페르소나의 질문 중 특히 중요한 것들]

## 다음 단계 제안
1. [우선 조치 사항]
2. [중기 개선 사항]
3. [장기 고려 사항]
```

### Step 5: 결과 저장 (선택)

`AskUserQuestion`으로 확인:
- "리포트를 파일로 저장" — `<문서명>-review-report.md`로 저장
- "이대로 종료" — 화면 출력만으로 종료

## 페르소나 설계 가이드

### 좋은 페르소나 정의 예시

| 페르소나 | 설명 | 적합한 문서 |
|---------|------|-------------|
| 시니어 백엔드 엔지니어 | 확장성, 유지보수성, 코드 품질 관점 | 기술 설계 문서 |
| 보안 전문가 | 위협 모델링, 취약점, 데이터 보호 관점 | 보안 관련 모든 문서 |
| 주니어 개발자 | 이해하기 쉬운지, 온보딩 관점 | README, 가이드 |
| CTO | 기술 전략, ROI, 리스크 관점 | 기술 제안서 |
| 잠재 투자자 | 시장성, 수익 모델, 경쟁력 관점 | 피치덱 |
| 최종 사용자 | 사용 편의성, 가치 전달 관점 | 제품 문서 |

### 효과적인 패널 구성 원칙

1. **다양성**: 서로 다른 배경과 관심사를 가진 페르소나로 구성
2. **적정 규모**: 3-5명이 적합 (너무 많으면 중복, 너무 적으면 관점 부족)
3. **문서 연관성**: 문서의 목적과 대상 독자에 맞는 페르소나 선택
4. **긴장 관계**: 서로 상충할 수 있는 관점을 포함 (예: 보안 vs 사용 편의성)

## 예외사항

### 문서를 찾을 수 없는 경우
"지정한 문서를 찾을 수 없습니다: `<경로>`"를 출력하고 종료한다.

### 페르소나가 1명인 경우
"패널 검토에는 최소 2명의 페르소나가 필요합니다."를 안내하고 추가 페르소나를 요청한다.

### 병렬 모드에서 에이전트 팀 미활성화
에이전트 팀 기능이 비활성화되어 있으면 활성화 방법을 안내하고 순차 모드로 폴백할지 `AskUserQuestion`으로 확인한다.

### 문서가 너무 큰 경우
문서가 2000줄을 초과하면 "문서가 매우 큽니다 (<N>줄). 전체 검토에 시간이 걸릴 수 있습니다."를 안내하고, 특정 섹션만 검토할지 확인한다.

## Related Files

| File | Purpose |
|------|---------|
| `custom/workflow/agent-team/SKILL.md` | 병렬 모드에서 사용하는 에이전트 팀 워크플로우 참조 |
| `settings.json` | `CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS` 환경 변수 (병렬 모드) |
